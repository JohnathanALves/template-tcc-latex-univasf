DROP FUNCTION IF EXISTS CALCULATE_START_DATE;

DELIMITER //

CREATE FUNCTION CALCULATE_START_DATE(semester VARCHAR(255), course VARCHAR(255)) RETURNS VARCHAR(255) DETERMINISTIC
BEGIN
	DECLARE startdate BIGINT(10);

		IF course = 'adm' THEN
		CASE semester
			WHEN '2013.2' THEN SET startdate = UNIX_TIMESTAMP('2013-10-29');
			WHEN '2014.1' THEN SET startdate = UNIX_TIMESTAMP('2014-04-28');
			WHEN '2014.2' THEN SET startdate = UNIX_TIMESTAMP('2014-09-15');
			WHEN '2015.1' THEN SET startdate = UNIX_TIMESTAMP('2015-03-09');
			WHEN '2015.2' THEN SET startdate = UNIX_TIMESTAMP('2015-08-10');
			WHEN '2016.1' THEN SET startdate = UNIX_TIMESTAMP('2016-04-04');
			WHEN '2016.2' THEN SET startdate = UNIX_TIMESTAMP('2016-09-19');
			WHEN '2017.1' THEN SET startdate = UNIX_TIMESTAMP('2017-08-19');
			ELSE SET startdate = UNIX_TIMESTAMP('2017-08-19');
		END CASE;
	ELSE
		CASE semester
			WHEN '2014.2' THEN SET startdate = UNIX_TIMESTAMP('2014-09-10');
			WHEN '2015.1' THEN SET startdate = UNIX_TIMESTAMP('2015-03-09');
			WHEN '2015.2' THEN SET startdate = UNIX_TIMESTAMP('2015-08-10');
			WHEN '2016.1' THEN SET startdate = UNIX_TIMESTAMP('2016-04-18');
			WHEN '2016.2' THEN SET startdate = UNIX_TIMESTAMP('2016-09-19');
			WHEN '2017.1' THEN SET startdate = UNIX_TIMESTAMP('2017-02-20');
			WHEN '2017.2' THEN SET startdate = UNIX_TIMESTAMP('2017-09-25');
			WHEN '2018.1' THEN SET startdate = UNIX_TIMESTAMP('2018-03-01');
			ELSE SET startdate = UNIX_TIMESTAMP('2018-03-01');
		END CASE;
	END IF;

	RETURN startdate;
END//

DELIMITER ;
